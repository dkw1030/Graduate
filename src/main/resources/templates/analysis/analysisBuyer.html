<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Portal - Bootstrap 5 Admin Dashboard Template For Developers</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Portal - Bootstrap 5 Admin Dashboard Template For Developers">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">
    <link rel="shortcut icon" th:href="@{/favicon.ico}">

    <!-- FontAwesome JS-->
    <script defer th:src="@{/assets/plugins/fontawesome/js/all.min.js}"></script>

    <!-- App CSS -->
    <link id="theme-style" rel="stylesheet" th:href="@{/assets/css/portal.css}">

</head>

<body class="app">
<header class="app-header fixed-top">
    <div th:replace="common/header::header(${user})"></div>
    <div th:replace="common/sidepanel::sidepanel(${sidePanel})"></div>
</header><!--//app-header-->

<div class="app-wrapper">

    <div class="app-content pt-3 p-md-3 p-lg-4">
        <div class="container-xl">

            <div class="row g-4 mb-4" th:if="${data!=null}">
                <div class="col-12 col-lg-6">
                    <div class="app-card app-card-chart h-100 shadow-sm">
                        <div class="app-card-header p-3 border-0">
                            <h4 class="app-card-title">总体确认率</h4>
                        </div><!--//app-card-header-->
                        <div class="app-card-body p-4">
                            <div class="chart-container">
                                <canvas id="chart-pie" ></canvas>
                            </div>
                        </div><!--//app-card-body-->
                    </div><!--//app-card-->
                </div><!--//col-->
                <div class="col-12 col-lg-6">
                    <div class="app-card app-card-chart h-100 shadow-sm">
                        <div class="app-card-header p-3 border-0">
                            <h4 class="app-card-title">总体完成率</h4>
                        </div><!--//app-card-header-->
                        <div class="app-card-body p-4">
                            <div class="chart-container">
                                <canvas id="finish" ></canvas>
                            </div>
                        </div><!--//app-card-body-->
                    </div><!--//app-card-->
                </div><!--//col-->
                <div class="col-12 col-lg-6">
                    <div class="app-card app-card-chart h-100 shadow-sm">
                        <div class="app-card-header p-3 border-0">
                            <h4 class="app-card-title">金额</h4>
                        </div><!--//app-card-header-->
                        <div class="app-card-body p-4">
                            <div class="chart-container">
                                <canvas id="chart-doughnut" ></canvas>
                            </div>
                        </div><!--//app-card-body-->
                    </div><!--//app-card-->
                </div><!--//col-->
                <div class="col-12 col-lg-6">
<!--                    <div class="app-card app-card-chart h-100 shadow-sm">-->
<!--                        <div class="app-card-header p-3 border-0">-->
<!--                            <h4 class="app-card-title">金额</h4>-->
<!--                        </div>&lt;!&ndash;//app-card-header&ndash;&gt;-->
                        <div class="app-card-body p-4">
                            <div class="chart-container">
                                <div class="row g-4 mb-4">
                                    <div class="col-6">
                                        <div class="app-card app-card-stat shadow-sm h-100">
                                            <div class="app-card-body p-3 p-lg-4">
                                                <h4 class="stats-type mb-1">待接单</h4>
                                                <div class="stats-figure" th:text="${'$'+data.getFinish()}"></div>
                                            </div><!--//app-card-body-->
                                            <a class="app-card-link-mask" href="#"></a>
                                        </div><!--//app-card-->
                                    </div><!--//col-->
                                    <div class="col-6">
                                        <div class="app-card app-card-stat shadow-sm h-100">
                                            <div class="app-card-body p-3 p-lg-4">
                                                <h4 class="stats-type mb-1">生产中</h4>
                                                <div class="stats-figure" th:text="${'$'+data.getProducing()}"></div>
                                            </div><!--//app-card-body-->
                                            <a class="app-card-link-mask" href="#"></a>
                                        </div><!--//app-card-->
                                    </div><!--//col-->
                                </div><!--//row-->
                                <div class="row g-4 mb-4">

                                    <div class="col-6">
                                        <div class="app-card app-card-stat shadow-sm h-100">
                                            <div class="app-card-body p-3 p-lg-4">
                                                <h4 class="stats-type mb-1">运输中</h4>
                                                <div class="stats-figure" th:text="${'$'+data.getDelivering()}"></div>
                                            </div><!--//app-card-body-->
                                            <a class="app-card-link-mask" href="#"></a>
                                        </div><!--//app-card-->
                                    </div><!--//col-->
                                    <div class="col-6">
                                        <div class="app-card app-card-stat shadow-sm h-100">
                                            <div class="app-card-body p-3 p-lg-4">
                                                <h4 class="stats-type mb-1">已完成</h4>
                                                <div class="stats-figure" th:text="${'$'+data.getFin()}"></div>
                                            </div><!--//app-card-body-->
                                            <a class="app-card-link-mask" href="#"></a>
                                        </div><!--//app-card-->
                                    </div><!--//col-->
                                </div><!--//row-->
                            </div>
                        </div><!--//app-card-body-->
<!--                    </div>&lt;!&ndash;//app-card&ndash;&gt;-->
                </div><!--//col-->

            </div><!--//row-->

        </div>
    </div><!--//app-content-->

    <footer class="app-footer">
        <div th:replace="common/footer::footer">
        </div>
    </footer><!--//app-footer-->

</div><!--//app-wrapper-->


<!-- Javascript -->
<script th:src="@{/assets/plugins/popper.min.js}"></script>
<script th:src="@{/assets/plugins/bootstrap/js/bootstrap.min.js}"></script>

<!-- Charts JS -->
<script th:src="@{/assets/plugins/chart.js/chart.min.js}"></script>
<script th:src="@{/assets/js/index-charts.js}"></script>
<!--<script th:src="@{/assets/js/charts-demo.js}"></script>-->
<script th:inline="javascript">

    window.chartColors = {
        green: '#75c181', // rgba(117,193,129, 1)
        blue: '#5b99ea', // rgba(91,153,234, 1)
        gray: '#a9b5c9',
        text: '#252930',
        border: '#e7e9ed'
    };

    var pieChartConfig = {
        type: 'pie',
        data: {
            datasets: [{
                data: [
                    [[${data.getOrderConfirmed()}]],
                    [[${data.getOrderRejected()}]],
                    // [[${data}]],
                    // [[${data}]],
                ],
                backgroundColor: [
                    window.chartColors.green,
                    window.chartColors.blue,
                ],
                label: 'Dataset 1'
            }],
            labels: [
                '确认率',
                '驳回率',
            ]
        },
        options: {
            responsive: true,
            legend: {
                display: true,
                position: 'bottom',
                align: 'center',
            },

            tooltips: {
                titleMarginBottom: 10,
                bodySpacing: 10,
                xPadding: 16,
                yPadding: 16,
                borderColor: window.chartColors.border,
                borderWidth: 1,
                backgroundColor: '#fff',
                bodyFontColor: window.chartColors.text,
                titleFontColor: window.chartColors.text,

                /* Display % in tooltip - https://stackoverflow.com/questions/37257034/chart-js-2-0-doughnut-tooltip-percentages */
                callbacks: {
                    label: function(tooltipItem, data) {
                        //get the concerned dataset
                        var dataset = data.datasets[tooltipItem.datasetIndex];
                        //calculate the total of this data set
                        var total = dataset.data.reduce(function(previousValue, currentValue, currentIndex, array) {
                            return previousValue + currentValue;
                        });
                        //get the current items value
                        var currentValue = dataset.data[tooltipItem.index];
                        //calculate the precentage based on the total and current item, also this does a rough rounding to give a whole number
                        var percentage = Math.floor(((currentValue/total) * 100)+0.5);

                        return percentage + "%";
                    },
                },


            },
        }
    };

    var finishConfig = {
        type: 'pie',
        data: {
            datasets: [{
                data: [
                    [[${data.getOrderCompleted()}]],
                    [[${data.getOrderFailed()}]],
                    // [[${data}]],
                    // [[${data}]],
                ],
                backgroundColor: [
                    window.chartColors.green,
                    window.chartColors.blue,
                ],
                label: 'Dataset 1'
            }],
            labels: [
                '确认率',
                '驳回率',
            ]
        },
        options: {
            responsive: true,
            legend: {
                display: true,
                position: 'bottom',
                align: 'center',
            },

            tooltips: {
                titleMarginBottom: 10,
                bodySpacing: 10,
                xPadding: 16,
                yPadding: 16,
                borderColor: window.chartColors.border,
                borderWidth: 1,
                backgroundColor: '#fff',
                bodyFontColor: window.chartColors.text,
                titleFontColor: window.chartColors.text,

                /* Display % in tooltip - https://stackoverflow.com/questions/37257034/chart-js-2-0-doughnut-tooltip-percentages */
                callbacks: {
                    label: function(tooltipItem, data) {
                        //get the concerned dataset
                        var dataset = data.datasets[tooltipItem.datasetIndex];
                        //calculate the total of this data set
                        var total = dataset.data.reduce(function(previousValue, currentValue, currentIndex, array) {
                            return previousValue + currentValue;
                        });
                        //get the current items value
                        var currentValue = dataset.data[tooltipItem.index];
                        //calculate the precentage based on the total and current item, also this does a rough rounding to give a whole number
                        var percentage = Math.floor(((currentValue/total) * 100)+0.5);

                        return percentage + "%";
                    },
                },


            },
        }
    };

    var doughnutChartConfig = {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [
                    [[${data.getProducing()}]],
                    [[${data.getDelivering()}]],
                    [[${data.getFinish()}]],
                ],
                backgroundColor: [
                    window.chartColors.green,
                    window.chartColors.blue,
                    window.chartColors.gray,
                ],
                label: 'Dataset 1'
            }],
            labels: [
                '生产中',
                '运输中',
                '待接单',
            ]
        },
        options: {
            responsive: true,
            legend: {
                display: true,
                position: 'bottom',
                align: 'center',
            },

            tooltips: {
                titleMarginBottom: 10,
                bodySpacing: 10,
                xPadding: 16,
                yPadding: 16,
                borderColor: window.chartColors.border,
                borderWidth: 1,
                backgroundColor: '#fff',
                bodyFontColor: window.chartColors.text,
                titleFontColor: window.chartColors.text,

                animation: {
                    animateScale: true,
                    animateRotate: true
                },

                /* Display % in tooltip - https://stackoverflow.com/questions/37257034/chart-js-2-0-doughnut-tooltip-percentages */
                callbacks: {
                    label: function(tooltipItem, data) {
                        //get the concerned dataset
                        var dataset = data.datasets[tooltipItem.datasetIndex];
                        //calculate the total of this data set
                        var total = dataset.data.reduce(function(previousValue, currentValue, currentIndex, array) {
                            return previousValue + currentValue;
                        });
                        //get the current items value
                        var currentValue = dataset.data[tooltipItem.index];
                        //calculate the precentage based on the total and current item, also this does a rough rounding to give a whole number
                        var percentage = Math.floor(((currentValue/total) * 100)+0.5);

                        return percentage + "%";
                    },
                },


            },
        }
    };

    // Generate charts on load
    window.addEventListener('load', function(){

        // var lineChart = document.getElementById('chart-line').getContext('2d');
        // window.myLine = new Chart(lineChart, lineChartConfig);
        //
        // var barChart = document.getElementById('chart-bar').getContext('2d');
        // window.myBar = new Chart(barChart, barChartConfig);
        //
        var pieChart = document.getElementById('chart-pie').getContext('2d');
        window.myPie = new Chart(pieChart, pieChartConfig);

        var finish = document.getElementById('finish').getContext('2d');
        window.myPie = new Chart(finish, finishConfig);

        var doughnutChart = document.getElementById('chart-doughnut').getContext('2d');
        window.myDoughnut = new Chart(doughnutChart, doughnutChartConfig);


    });
</script>
<!-- Page Specific JS -->
<script th:src="@{/assets/js/app.js}"></script>

</body>
</html>

